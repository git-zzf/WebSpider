# “淘宝商品比价定向爬虫”实例介绍

## 功能描述

目标：获取淘宝搜索页面的信息，提取其中的商品名称和价格

理解：

1. 获得淘宝的搜索接口，通过程序向淘宝提交请求并获得返回的结果。
2. 翻页的处理

技术路线：requests-re



## 分析起始页URL

分析搜索“书包”关键词的淘宝url：

```
https://s.taobao.com/search?q=书包&imgfile=&commend=all&ssid=s5-e&search_type=item&sourceId=tb.index&spm=a21bo.2017.201856-taobao-item.1&ie=utf8&initiative_id=tbindexz_20170306
```

实际中：书包的部分是`%E4%B9%A6%E5%8C%85`

```
https://s.taobao.com/search?q=%E4%B9%A6%E5%8C%85&imgfile=&commend=all&ssid=s5-e&search_type=item&sourceId=tb.index&spm=a21bo.2017.201856-taobao-item.1&ie=utf8&initiative_id=tbindexz_20170306
```

可以看到，q就是引入关键词的变量，所以`https://s.taobao.com/search?q=书包`这一部分就可以作为向淘宝提交关键词的链接接口。



## 分析翻页URL

第二页：

```
https://s.taobao.com/search?q=%E4%B9%A6%E5%8C%85&imgfile=&commend=all&ssid=s5-e&search_type=item&sourceId=tb.index&spm=a21bo.2017.201856-taobao-item.1&ie=utf8&initiative_id=tbindexz_20170306&bcoffset=3&ntoffset=3&p4ppushleft=1%2C48&s=44
```

第三页:

```
https://s.taobao.com/search?q=%E4%B9%A6%E5%8C%85&imgfile=&commend=all&ssid=s5-e&search_type=item&sourceId=tb.index&spm=a21bo.2017.201856-taobao-item.1&ie=utf8&initiative_id=tbindexz_20170306&bcoffset=0&ntoffset=6&p4ppushleft=1%2C48&s=88
```

发现第二页和第三页的链接，最后的s变量不同，第二页中<font color = red>`s = 44`  </font>，第三页中<font color = red>`s = 88`  </font>，这是因为淘宝一页显示44个商品。这个s表示的是第二页和第三页起始商品的编号。（实际中，第一页47个商品）

通过这两个分析，我们可以得到淘宝提交搜索的接口以及对应每一个不同翻页的url的参数变量



## 程序的结构设计

步骤1：提交商品搜索请求，循环获取页面

步骤2：对于每个页面，提取商品名称和价格信息

步骤3：将信息输出到屏幕上